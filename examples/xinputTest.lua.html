

<!DOCTYPE html>
<html>
	<head>
		<title>xinputTest.lua :: StarfallEx Reference</title>
		<link rel="stylesheet" href="../assets/stylesheet.css" type="text/css">
		<script> fromPath = "../"; </script>
		<script src="../assets/js/common.js"></script>
		<script src="../assets/js/search.js"></script>
	</head>
	<body>
		<nav>
			<section>
				<h1>StarfallEx Reference</h1>
				<ul>
					<li><a href="../index.html">Home</a></li>
				</ul>
			</section>
			<section id="search">
				<input type="search" id="search_field" placeholder="Search...">
			</section>
			<section id="common_index">
				<section>
					<h1>Libraries</h1>
					<ul>
						
						<li><a href="../libraries/bass.html">bass</a></li>
						<li><a href="../libraries/bit.html">bit</a></li>
						<li><a href="../libraries/builtin.html">builtin</a></li>
						<li><a href="../libraries/constraint.html">constraint</a></li>
						<li><a href="../libraries/coroutine.html">coroutine</a></li>
						<li><a href="../libraries/effect.html">effect</a></li>
						<li><a href="../libraries/fastlz.html">fastlz</a></li>
						<li><a href="../libraries/file.html">file</a></li>
						<li><a href="../libraries/find.html">find</a></li>
						<li><a href="../libraries/game.html">game</a></li>
						<li><a href="../libraries/holograms.html">holograms</a></li>
						<li><a href="../libraries/hook.html">hook</a></li>
						<li><a href="../libraries/http.html">http</a></li>
						<li><a href="../libraries/input.html">input</a></li>
						<li><a href="../libraries/joystick.html">joystick</a></li>
						<li><a href="../libraries/json.html">json</a></li>
						<li><a href="../libraries/light.html">light</a></li>
						<li><a href="../libraries/material.html">material</a></li>
						<li><a href="../libraries/mesh.html">mesh</a></li>
						<li><a href="../libraries/net.html">net</a></li>
						<li><a href="../libraries/particle.html">particle</a></li>
						<li><a href="../libraries/physenv.html">physenv</a></li>
						<li><a href="../libraries/prop.html">prop</a></li>
						<li><a href="../libraries/quaternion.html">quaternion</a></li>
						<li><a href="../libraries/render.html">render</a></li>
						<li><a href="../libraries/sounds.html">sounds</a></li>
						<li><a href="../libraries/sql.html">sql</a></li>
						<li><a href="../libraries/team.html">team</a></li>
						<li><a href="../libraries/timer.html">timer</a></li>
						<li><a href="../libraries/trace.html">trace</a></li>
						<li><a href="../libraries/von.html">von</a></li>
						<li><a href="../libraries/wire.html">wire</a></li>
						<li><a href="../libraries/xinput.html">xinput</a></li>
					</ul>
				</section>
				<section>
					<h1>Types</h1>
					<ul>
						
						<li><a href="../classes/Angle.html">Angle</a></li>
						<li><a href="../classes/Bass.html">Bass</a></li>
						<li><a href="../classes/Color.html">Color</a></li>
						<li><a href="../classes/Effect.html">Effect</a></li>
						<li><a href="../classes/Entity.html">Entity</a></li>
						<li><a href="../classes/File.html">File</a></li>
						<li><a href="../classes/Hologram.html">Hologram</a></li>
						<li><a href="../classes/Light.html">Light</a></li>
						<li><a href="../classes/Material.html">Material</a></li>
						<li><a href="../classes/Mesh.html">Mesh</a></li>
						<li><a href="../classes/Npc.html">Npc</a></li>
						<li><a href="../classes/Particle.html">Particle</a></li>
						<li><a href="../classes/PhysObj.html">PhysObj</a></li>
						<li><a href="../classes/Player.html">Player</a></li>
						<li><a href="../classes/Quaternion.html">Quaternion</a></li>
						<li><a href="../classes/Sound.html">Sound</a></li>
						<li><a href="../classes/StringStream.html">StringStream</a></li>
						<li><a href="../classes/VMatrix.html">VMatrix</a></li>
						<li><a href="../classes/Vector.html">Vector</a></li>
						<li><a href="../classes/Vehicle.html">Vehicle</a></li>
						<li><a href="../classes/Weapon.html">Weapon</a></li>
						<li><a href="../classes/Wirelink.html">Wirelink</a></li>
					</ul>
				</section>
				<section>
					<h1>Hooks</h1>
					<ul>
						
						<li><span class="realm_sv"></span><a href="../hooks.html#Dupefinished">Dupefinished</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#EndEntityDriving">EndEntityDriving</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#EntityFireBullets">EntityFireBullets</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#EntityRemoved">EntityRemoved</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#EntityTakeDamage">EntityTakeDamage</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#FinishChat">FinishChat</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#GravGunOnDropped">GravGunOnDropped</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#GravGunOnPickedUp">GravGunOnPickedUp</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#GravGunPunt">GravGunPunt</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#KeyPress">KeyPress</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#KeyRelease">KeyRelease</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#NetworkEntityCreated">NetworkEntityCreated</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#OnEntityCreated">OnEntityCreated</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#OnPhysgunFreeze">OnPhysgunFreeze</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#OnPhysgunReload">OnPhysgunReload</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#PhysgunDrop">PhysgunDrop</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#PhysgunPickup">PhysgunPickup</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#PlayerCanPickupWeapon">PlayerCanPickupWeapon</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#PlayerChat">PlayerChat</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#PlayerDeath">PlayerDeath</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#PlayerDisconnected">PlayerDisconnected</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#PlayerEnteredVehicle">PlayerEnteredVehicle</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#PlayerHurt">PlayerHurt</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#PlayerInitialSpawn">PlayerInitialSpawn</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#PlayerLeaveVehicle">PlayerLeaveVehicle</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#PlayerNoClip">PlayerNoClip</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#PlayerSay">PlayerSay</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#PlayerSpawn">PlayerSpawn</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#PlayerSpray">PlayerSpray</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#PlayerSwitchFlashlight">PlayerSwitchFlashlight</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#PlayerSwitchWeapon">PlayerSwitchWeapon</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#PlayerUse">PlayerUse</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#PropBreak">PropBreak</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#Removed">Removed</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#StartChat">StartChat</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#StartEntityDriving">StartEntityDriving</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#calcview">calcview</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#drawhud">drawhud</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#hologrammatrix">hologrammatrix</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#hudconnected">hudconnected</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#huddisconnected">huddisconnected</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#input">input</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#inputPressed">inputPressed</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#inputReleased">inputReleased</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#mouseWheeled">mouseWheeled</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#mousemoved">mousemoved</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#net">net</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#permissionrequest">permissionrequest</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#postdrawhud">postdrawhud</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#postdrawopaquerenderables">postdrawopaquerenderables</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#predrawhud">predrawhud</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#predrawopaquerenderables">predrawopaquerenderables</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#readcell">readcell</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#remote">remote</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#render">render</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#renderoffscreen">renderoffscreen</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#starfallUsed">starfallUsed</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#think">think</a></li>
						<li><span class="realm_sh"></span><a href="../hooks.html#tick">tick</a></li>
						<li><span class="realm_sv"></span><a href="../hooks.html#writecell">writecell</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#xinputConnected">xinputConnected</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#xinputDisconnected">xinputDisconnected</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#xinputPressed">xinputPressed</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#xinputReleased">xinputReleased</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#xinputStick">xinputStick</a></li>
						<li><span class="realm_cl"></span><a href="../hooks.html#xinputTrigger">xinputTrigger</a></li>
					</ul>
				</section>
				<section>
					<h1>Preprocessor directives</h1>
					<ul>
						
						<li><a href="../directives.html#client">--@client</a></li>
						<li><a href="../directives.html#include">--@include</a></li>
						<li><a href="../directives.html#includedir">--@includedir</a></li>
						<li><a href="../directives.html#model">--@model</a></li>
						<li><a href="../directives.html#name">--@name</a></li>
						<li><a href="../directives.html#server">--@server</a></li>
					</ul>
				</section>
			</section>
			<section id="search_index" style="display: none;">
				<section>
					<h1>Functions</h1>
					<ul id="search_functions">
						
					</ul>
				</section>
				<section>
					<h1>Methods</h1>
					<ul id="search_methods">
						
					</ul>
				</section>
				<section>
					<h1>Hooks</h1>
					<ul id="search_hooks">
						
					</ul>
				</section>
			</section>
		</nav>
		<main>

<h1>xinputTest.lua</h1>
<section>
	<h2>SF code</h2>
	<code>--@name XInput Test
--@author mitterdoo
--@client

-- Renders a rectangle and colors it based on the bool value of b
local function button(b, x, y, w, h)
    if b then
        render.setRGBA(0,255,0,255)
    else
        render.setRGBA(255,0,0,255)
    end
    render.drawRect(x, y, w, h)
end

local controllerIdx = 0 -- This is the index for the controller to show the input of. It begins at 0

local softRumble = 0
local hardRumble = 0

hook.add("render", "", function()

    if xinput.getState(controllerIdx) then-- This shows we're connected
    
        render.setRGBA(255,255,255,255)
        render.drawText(0, 0, "CONTROLLER " .. controllerIdx .. " CONNECTED", 0)
    
    end
    local cx, cy = 100, 200 -- Center of the left dpad
    local dist = 10 -- Distance between center, and the inside endpoints of the button line
    local size = 40 -- Length of a dpad button
    local wide = 10 -- Width of a dpad button
    local tsize = 100 -- Height of trigger
    
    button(xinput.getButton(controllerIdx, 0x1), cx - wide/2, cy - dist - size, wide, size) -- Up
    button(xinput.getButton(controllerIdx, 0x2), cx - wide/2, cy + dist, wide, size) -- Down
    button(xinput.getButton(controllerIdx, 0x4), cx - dist - size, cy - wide/2, size, wide) -- Left
    button(xinput.getButton(controllerIdx, 0x8), cx + dist, cy - wide/2, size, wide) -- Right
    button(xinput.getButton(controllerIdx, 0x100), cx - dist - size, cy - dist - size - wide, size*2 + dist*2, wide) -- Left shoulder
    render.setRGBA(255,0,0,255)
    render.drawRect(cx - dist - size, cy - dist - size - wide*2 - tsize, size*2 + dist*2, tsize) -- Trigger BG
    
    render.setRGBA(0,255,0,255)
    local perc = xinput.getTrigger(controllerIdx, 0) / 255
    render.drawRect(cx - dist - size, cy - dist - size - wide*2 - tsize*perc, size*2 + dist*2, tsize*perc) -- Left Trigger
    
    cx, cy = 300, 200 -- Move centerpoint to right
    button(xinput.getButton(controllerIdx, 0x8000), cx - wide/2, cy - dist - size, wide, size) -- Y
    button(xinput.getButton(controllerIdx, 0x1000), cx - wide/2, cy + dist, wide, size) -- A
    button(xinput.getButton(controllerIdx, 0x4000), cx - dist - size, cy - wide/2, size, wide) -- X
    button(xinput.getButton(controllerIdx, 0x2000), cx + dist, cy - wide/2, size, wide) -- B
    button(xinput.getButton(controllerIdx, 0x200), cx - dist - size, cy - dist - size - wide, size*2 + dist*2, wide) -- Right shoulder
    
    button(xinput.getButton(controllerIdx, 0x20), 50 + 110, 150, 5, 20) -- Back
    button(xinput.getButton(controllerIdx, 0x10), 250 - 15, 150, 5, 20) -- Start
    
    button(xinput.getButton(controllerIdx, 0x40), 50, 300, 100, 100) -- Left thumb button
    button(xinput.getButton(controllerIdx, 0x80), 250, 300, 100, 100) -- Right thumb button
    render.setRGBA(255,0,0,255)
    render.drawRect(cx - dist - size, cy - dist - size - wide*2 - tsize, size*2 + dist*2, tsize) -- Trigger BG
    
    render.setRGBA(0,255,0,255)
    local perc = xinput.getTrigger(controllerIdx, 1) / 255
    render.drawRect(cx - dist - size, cy - dist - size - wide*2 - tsize*perc, size*2 + dist*2, tsize*perc) -- Right Trigger
    
    render.setRGBA(0,0,0,255)
    cx, cy = 50+50, 300+50 -- Move centerpoint to below trigger for stick
    size = 100 -- Width of the stick region
    local blip = 4 -- Size of the "blip" that marks where the stick is located
    
    local x, y = xinput.getStick(controllerIdx, 0)
    render.drawRect(cx + x/65535*size-blip/2, cy + -y/65535*size-blip/2, blip, blip) -- Left stick position
    
    cx, cy = 250+50, 300+50 -- Move centerpoint to the right
    local x, y = xinput.getStick(controllerIdx, 1)
    render.drawRect(cx + x/65535*size-blip/2, cy + -y/65535*size-blip/2, blip, blip) -- Right stick position
    
    
    local cursor_x, cursor_y = render.cursorPos()
    local useKey = input.lookupBinding("+use")
    local held = cursor_x and input.isKeyDown(useKey) -- If cursor_x is nil (player isn't looking at screen), don't bother with slider maths)
    
    local bx1, by1, bw, bh = 400, 100, 40, 200
    local bx2, by2 = bx1 + bw, by1 + bh -- Get the boundary of the slider
    
    render.setRGBA(255,0,0,255)
    render.drawRect(bx1, by1, bw, bh)
    
    if held and bx1 <= cursor_x and cursor_x <= bx2 and by1 <= cursor_y and cursor_y <= by2 then -- Checks if the cursor is inside the slider
        local percent = 1 - (cursor_y - by1) / bh
        softRumble = percent
        
    end
    
    render.setRGBA(0,255,0,255)
    render.drawRect(bx1, by2 - bh*softRumble, bw, bh*softRumble) -- Draws a variable-height rectangle, locked to the bottom
    
    bx1, by1, bw, bh = 450, 100, 40, 200
    bx2, by2 = bx1 + bw, by1 + bh -- Get the boundary of the slider
    render.setRGBA(255,0,0,255)
    render.drawRect(bx1, by1, bw, bh)
    
    if held and bx1 <= cursor_x and cursor_x <= bx2 and by1 <= cursor_y and cursor_y <= by2 then -- Checks if the cursor is inside the slider
        local percent = 1 - (cursor_y - by1) / bh
        hardRumble = percent
    end
    
    render.setRGBA(0,255,0,255)
    render.drawRect(bx1, by2 - bh*hardRumble, bw, bh*hardRumble) -- Draws a variable-height rectangle, locked to the bottom
    
    render.setRGBA(255,255,255,255)
    render.drawText(420, 110, "SOFT", 1)
    render.drawText(470, 110, "HARD", 1)
    render.drawText(445, 310, "RUMBLE (PRESS USE)", 1)
    
    xinput.setRumble(controllerIdx, softRumble, hardRumble)
    
    
end)
</code>
</section>
		</main>
		<footer>
			<p>
				StarfallEx Reference. Generated with LuaDoc.
			</p>
			<p>
				<a href="https://github.com/thegrb93/StarfallEx" target="_blank">GitHub</a>
				<a href="https://discord.gg/KPa4cJp" target="_blank">Discord</a>
			</p>
		</footer>
	</body>
</html>
